## Monoid Dashboard – code graph & docs viewer

This app is a minimal Next.js dashboard for exploring code graphs and lightweight documentation generated by the Monoid VS Code extension.

### What it does

- **Graph view**: `/graph/[versionId]`  
  Renders an interactive dependency graph for a single `repo_versions.id`, using:
  - `code_nodes` (nodes)
  - `code_edges` (edges)

- **Docs view**: `/docs/[orgId]` and `/docs/[orgId]/[docSlug]`  
  CRUD UI for markdown documents stored in `org_docs`, grouped by `organizations`. Docs can deep-link back into the graph via node IDs.

- **Share view**: `/share/[orgSlug]/[docSlug]`  
  Public, read-only view of published docs.

There is **no authentication** in this open-source POC; everything is public, backed by a Supabase anon key.

### Supabase configuration

The dashboard uses a single public Supabase client configured via environment variables:

- `NEXT_PUBLIC_SUPABASE_URL`
- `NEXT_PUBLIC_SUPABASE_ANON_KEY`

These must point to a project that has the Monoid schema installed (see the plan file in the extension repo).

For the included public demo, RLS is disabled on:

- `workspaces`
- `repos`
- `repo_versions`
- `code_nodes`
- `code_edges`
- `organizations`
- `org_docs`

so reads/writes work with just the anon key.

### Data model overview

Core graph tables:

- `workspaces` – top-level grouping, usually one per VS Code workspace.
- `repos` – repository rows, linked to `workspaces` and optionally `organizations`.
- `repo_versions` – each visualization run (commit SHA + branch + counts).
- `code_nodes` – individual code elements (functions, components, endpoints, etc.).
- `code_edges` – relationships between nodes (`calls`, `imports`, `depends_on`, etc.).

Docs tables:

- `organizations` – logical orgs, used to group repos and docs.
- `org_docs` – markdown documents for an org, optionally linked to a repo.

The VS Code extension (`monoid-visualize`) writes graph data and ensures:

- A deterministic `organizations` row exists for each repo (based on git owner or workspace slug).
- `repos.organization_id` is always populated, so this dashboard can group repos on the home page.

### Local development

1. Set environment variables:

   ```bash
   NEXT_PUBLIC_SUPABASE_URL=...        # demo or your own
   NEXT_PUBLIC_SUPABASE_ANON_KEY=...
   ```

2. Install dependencies and run the dev server:

   ```bash
   npm install
   npm run dev
   ```

3. With the VS Code extension configured to point at this URL (e.g., `http://localhost:3000`), run:
   - **“Monoid: Visualize All Code”** in VS Code.

4. Open:
   - `/` to see organizations, repos, and latest versions.
   - `/graph/[versionId]` to view the graph.
   - `/docs/[orgId]` to manage docs.

### What was removed for the POC

Compared to the internal version, this OSS dashboard intentionally omits:

- Test result dashboards and test-coverage visualizations.
- Roadmap UI and GitHub webhook ingestion.
- MCP server endpoints for AI agents.
- GitHub OAuth and any sign-in/sign-out flows.

All remaining routes are public and driven purely by the Supabase anon client.

