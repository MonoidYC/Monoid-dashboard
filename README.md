## Monoid Dashboard – code graph & docs viewer

This app is a minimal Next.js dashboard for exploring code graphs and lightweight documentation generated by the Monoid VS Code extension.

### Scope

This dashboard focuses on **visualization only**: graph view, docs, and share. Code for **automatic e2e test generation with Playwright** from the hackathon lives in the **`hackathon-archive`** branch of the monoid-visualize repo; this dashboard intentionally focuses on the graph and docs experience only.

### What it does

- **Graph view**: `/graph/[versionId]`  
  Renders an interactive dependency graph for a single `repo_versions.id`, using:
  - `code_nodes` (nodes)
  - `code_edges` (edges)

- **Docs view**: `/docs/[orgId]` and `/docs/[orgId]/[docSlug]`  
  CRUD UI for markdown documents stored in `org_docs`, grouped by `organizations`. Docs can deep-link back into the graph via node IDs.

- **Share view**: `/share/[orgSlug]/[docSlug]`  
  Public, read-only view of published docs (no sign-in required).

### Authentication

The dashboard uses **Supabase Auth** with **email/password** sign-in and sign-up. Sign-in and sign-up are at `/login`. Middleware protects most routes: unauthenticated users are redirected to `/login`. The **share** route (`/share/[orgSlug]/[docSlug]`) and the login page are public; graph and docs routes require an authenticated session.

### Tested frameworks & community

The Monoid stack (extension + dashboard) has been tested with **Vue.js** and **React.js** apps. Support for more libraries and frameworks is not yet validated—we need **community members to test and contribute fixes** so the graph and docs experience work well across more ecosystems. Issues and PRs are welcome.

### Supabase configuration

The dashboard uses a single public Supabase client configured via environment variables:

- `NEXT_PUBLIC_SUPABASE_URL`
- `NEXT_PUBLIC_SUPABASE_ANON_KEY`

These must point to a project that has the Monoid schema installed (see the plan file in the extension repo).

Session handling uses the same Supabase project; the anon key is used with cookies for auth. For the included public demo, RLS may be disabled on the graph/docs tables so that the extension and dashboard can read/write with the anon key; for self-hosted deployments you can enable RLS and scope data by user.

### Data model overview

Core graph tables:

- `workspaces` – top-level grouping, usually one per VS Code workspace.
- `repos` – repository rows, linked to `workspaces` and optionally `organizations`.
- `repo_versions` – each visualization run (commit SHA + branch + counts).
- `code_nodes` – individual code elements (functions, components, endpoints, etc.).
- `code_edges` – relationships between nodes (`calls`, `imports`, `depends_on`, etc.).

Docs tables:

- `organizations` – logical orgs, used to group repos and docs.
- `org_docs` – markdown documents for an org, optionally linked to a repo.

The VS Code extension (`monoid-visualize`) writes graph data and ensures:

- A deterministic `organizations` row exists for each repo (based on git owner or workspace slug).
- `repos.organization_id` is always populated, so this dashboard can group repos on the home page.

### Local development

1. Set environment variables:

   ```bash
   NEXT_PUBLIC_SUPABASE_URL=...        # demo or your own
   NEXT_PUBLIC_SUPABASE_ANON_KEY=...
   ```

2. Install dependencies and run the dev server:

   ```bash
   npm install
   npm run dev
   ```

3. With the VS Code extension configured to point at this URL (e.g., `http://localhost:3000`), run:
   - **“Monoid: Visualize All Code”** in VS Code.

4. Open:
   - `/login` to sign in or create an account (email/password).
   - `/` to see organizations, repos, and latest versions (requires sign-in).
   - `/graph/[versionId]` to view the graph.
   - `/docs/[orgId]` to manage docs.
   - `/share/[orgSlug]/[docSlug]` for public, read-only docs (no sign-in).

### What was removed for the POC

Compared to the internal version, this OSS dashboard intentionally omits:

- Test result dashboards and test-coverage visualizations.
- Roadmap UI and GitHub webhook ingestion.
- MCP server endpoints for AI agents.
- GitHub OAuth (sign-in is email/password via Supabase Auth only).

Graph and docs routes require sign-in; share and login are the only public routes.

